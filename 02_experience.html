<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EXPERIENCEï½œKohei Portal</title>
  <meta name="description" content="ãŠã“ã’ï¼ˆLOVOTï¼‰/ çµŒé¨“å€¤ãƒãƒƒãƒ— / ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ / åˆ¶ä½œãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’ç¸¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã§æ¥½ã—ã‚ã‚‹å€‹äººãƒãƒ¼ã‚¿ãƒ«ã€‚" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700;900&display=swap" rel="stylesheet">

  <style>
    :root{
      --accent:#7c3aed;          /* purple */
      --accent2:#5b21b6;
      --bg-dark:#05060b;
      --bg-gray:#f5f5f7;
      --text:#1f2937;
      --muted:#6b7280;
      --max:1120px;
      --header:72px;
      --card:#ffffff;
      --border:#e7e7ef;
      --shadow:0 14px 34px rgba(0,0,0,.10);
      --radius:18px;
    }

    *{ box-sizing:border-box; }
    html,body{
      margin:0; padding:0;
      font-family:"Noto Sans JP", system-ui, -apple-system, "Segoe UI", sans-serif;
      color:var(--text);
      background:#fff;
      scroll-behavior:smooth;
    }
    a{ color:inherit; text-decoration:none; }
    img{ max-width:100%; display:block; }

    /* ---------------- Header ---------------- */
    header.header{
      position:fixed; inset:0 0 auto 0;
      height:var(--header);
      display:flex; align-items:center; justify-content:center;
      background:rgba(5,6,11,.90);
      backdrop-filter: blur(14px);
      color:#fff;
      z-index:1000;
    }
    .header-inner{
      width:100%; max-width:var(--max);
      padding:0 18px;
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
    }
    .logo{
      display:flex; align-items:center; gap:12px;
      min-width: 160px;
    }
    .logo-mark{
      width:34px; height:34px;
      border-radius:999px;
      background: radial-gradient(1200px 700px at 30% 20%, rgba(124,58,237,.18) 0%, rgba(2,6,23,0) 55%),
                radial-gradient(1000px 600px at 70% 30%, rgba(56,189,248,.12) 0%, rgba(2,6,23,0) 60%),
                linear-gradient(180deg, #070b14 0%, #050814 100%);
      box-shadow:0 10px 22px rgba(0,0,0,.35);
      display:flex; align-items:center; justify-content:center;
      font-weight:900;
    }
    .logo-text .main{
      font-size:12px; font-weight:900; letter-spacing:.18em; text-transform:uppercase;
      line-height:1.1;
    }
    .logo-text .sub{
      font-size:10px; opacity:.65; letter-spacing:.16em; text-transform:uppercase;
      line-height:1.1;
      margin-top:2px;
    }

    nav.nav{
      display:flex; align-items:center; gap:18px;
      font-size:12px;
    }
    nav.nav a{
      position:relative; padding-bottom:3px;
      opacity:.95;
    }
    nav.nav a::after{
      content:""; position:absolute; left:0; bottom:0; width:0; height:2px;
      background:var(--accent);
      transition: width .18s ease;
    }
    nav.nav a:hover::after{ width:100%; }
    .nav-cta{
      height:34px;
      padding:0 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.70);
      background:rgba(0,0,0,.25);
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
    }
    .nav-cta span{ font-size:16px; transform:translateY(1px); }

    /* Mobile toggle */
    .nav-toggle{
      display:none;
      width:28px; height:20px;
      flex-direction:column; justify-content:space-between;
      cursor:pointer;
    }
    .nav-toggle span{
      display:block; height:2px; border-radius:999px; background:#fff;
      transition: transform .2s ease, opacity .2s ease;
    }
    body.nav-open .nav-toggle span:nth-child(1){ transform:translateY(9px) rotate(45deg); }
    body.nav-open .nav-toggle span:nth-child(2){ opacity:0; }
    body.nav-open .nav-toggle span:nth-child(3){ transform:translateY(-9px) rotate(-45deg); }

    .nav-sp{
      display:none;
      position:fixed; inset:var(--header) 0 auto 0;
      background:rgba(5,6,11,.97);
      color:#fff;
      padding:16px 24px 24px;
      z-index:900;
    }
    .nav-sp a{
      display:block; padding:10px 0;
      border-bottom:1px solid rgba(255,255,255,.10);
      font-size:13px;
    }
    body.nav-open .nav-sp{ display:block; }

    /* ---------------- Hero ---------------- */
    .hero{
      padding-top:var(--header);
      min-height: 520px;
      background:
        linear-gradient(135deg, rgba(5,6,11,.20), rgba(5,6,11,.55)),
        radial-gradient(circle at 0% 0%, rgba(124,58,237,.20), rgba(5,6,11,.55) 55%),
        radial-gradient(circle at 100% 80%, rgba(91,33,182,.22), rgba(5,6,11,.65) 52%),
        url("images/hero_placeholder.jpg");
      background-size: cover;
      background-position: center;
      background-repeat:no-repeat;
      color:#fff;
      overflow:hidden;
      position:relative;
    }
    .hero-inner{
      max-width:var(--max);
      margin:0 auto;
      padding:52px 18px 64px;
      display:grid;
      grid-template-columns: minmax(0, 2.3fr) minmax(0, 1.7fr);
      gap:40px;
      align-items:center;
      position:relative;
      z-index:1;
    }
    .hero-label{
      font-size:11px; letter-spacing:.34em; text-transform:uppercase;
      opacity:.75; margin-bottom:14px;
    }
    .hero-title-en{
      font-size: clamp(28px, 3.9vw, 38px);
      font-weight: 900;
      letter-spacing:.14em;
      text-transform:uppercase;
      line-height:1.25;
    }
    .hero-title-ja{
      font-size:20px; font-weight:700;
      margin-top:10px;
    }
    .hero-lead{
      margin-top:14px;
      padding-left:10px;
      border-left:2px solid var(--accent);
      font-size:13px;
      line-height:1.95;
      max-width:520px;
      opacity:.92;
    }
    .hero-meta{
      margin-top:18px;
      font-size:12px; opacity:.82;
    }
    .btn-row{
      margin-top:22px;
      display:flex; flex-wrap:wrap; gap:12px; align-items:center;
    }
    .btn-primary{
      display:inline-flex; align-items:center; justify-content:center; gap:8px;
      border-radius:999px;
      padding:11px 20px;
      font-size:12px;
      font-weight:700;
      letter-spacing:.16em;
      text-transform:uppercase;
      border:none;
      cursor:pointer;
      color:#fff;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow:0 12px 26px rgba(0,0,0,.50);
      white-space:nowrap;
    }
    .btn-primary span{ font-size:16px; transform:translateY(1px); }
    .btn-secondary{
      font-size:11px;
      padding:9px 14px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.60);
      display:inline-flex; align-items:center; gap:8px;
      opacity:.92;
      white-space:nowrap;
    }
    .hero-right{
      border-radius: 20px;
      overflow:hidden;
      background: rgba(15, 18, 30, .55);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
      min-height: 260px;
      position:relative;
    }
    .hero-right::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 0% 0%, rgba(255,255,255,.14), rgba(255,255,255,0) 55%),
        linear-gradient(140deg, rgba(0,0,0,.55), rgba(0,0,0,.25));
      pointer-events:none;
    }
    .hero-right-inner{
      position:relative;
      padding:18px 18px 16px;
      color:#fff;
      font-size:12px;
      display:flex;
      flex-direction:column;
      height:100%;
      gap:10px;
    }
    .hero-right-head{
      font-size:11px; letter-spacing:.20em; text-transform:uppercase;
      opacity:.85;
    }
    .hero-right-title{
      font-size:16px; font-weight:800; line-height:1.55;
    }
    .hero-right-note{
      margin-top:2px;
      font-size:11px;
      opacity:.85;
      line-height:1.7;
    }
    .hero-right-kpi{
      margin-top:auto;
      display:flex; flex-wrap:wrap; gap:8px;
    }
    .pill{
      display:inline-flex; align-items:center; gap:6px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.22);
      font-size:11px;
      opacity:.95;
    }
    .pill strong{ font-weight:900; }

    /* ---------------- Quick Cards ---------------- */
    .category-nav{
      background:#fff;
      border-bottom:1px solid #e1e1e4;
    }
    .category-inner{
      max-width:var(--max);
      margin:0 auto;
      padding:16px 18px 22px;
      display:grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap:14px;
    }
    .cat-card{
      border-radius:14px;
      padding:14px 14px 12px;
      border:1px solid var(--border);
      background:#ffffff; cursor:pointer;
      display:grid;
      gap:6px;
      font-size:12px;
      transition: transform .16s ease, box-shadow .16s ease, border-color .16s ease;
    }
    .cat-card:hover{
      transform: translateY(-2px);
      box-shadow: 0 10px 24px rgba(0,0,0,.12);
      border-color: var(--accent);
    }
    .cat-label{
      font-size:10px; letter-spacing:.26em; text-transform:uppercase;
      color: var(--accent2);
    }
    .cat-title{ font-size:14px; font-weight:800; }
    .cat-text{ font-size:11px; color:#555; line-height:1.7; }
    .cat-link{
      margin-top:4px;
      font-size:11px;
      text-align:right;
      color: var(--accent2);
    }

    /* ---------------- Sections base ---------------- */
    main section{ padding: 72px 18px 76px; }
    .section-inner{ max-width:var(--max); margin:0 auto; }
    .section-label{
      font-size:11px; letter-spacing:.32em; text-transform:uppercase;
      color: var(--accent2);
      margin-bottom:10px;
    }
    .section-title{ font-size:24px; font-weight:900; margin:0 0 8px; }
    .section-title-sub{
      font-size:12px; letter-spacing:.16em; text-transform:uppercase;
      opacity:.62;
      margin-bottom:22px;
    }
    .section-lead{
      font-size:14px;
      line-height:1.95;
      max-width:760px;
      color:#444;
      margin:0 0 30px;
    }

    /* ---------------- Business Sections ---------------- */
    .sec-dark{
      background: var(--bg-dark);
      color:#fff;
      position:relative;
      overflow:hidden;
    }
    .sec-dark::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:
        radial-gradient(circle at 0% 0%, rgba(255,255,255,.08), transparent 60%),
        radial-gradient(circle at 100% 100%, rgba(124,58,237,.40), transparent 60%);
      opacity:.9;
    }
    .sec-dark .section-inner{ position:relative; z-index:1; }
    .sec-dark .section-label{ color: rgba(255,255,255,.72); }
    .sec-dark .section-title{ color:#fff; }
    .sec-dark .section-title-sub{ color: rgba(255,255,255,.70); opacity:1; }
    .sec-dark .section-lead{ color: rgba(255,255,255,.86); }

    .grid-2{
      display:grid;
      grid-template-columns: minmax(0, 1.55fr) minmax(0, 1.45fr);
      gap:28px;
      align-items:flex-start;
    }
    .panel{
      border-radius: var(--radius);
      border:1px solid rgba(255,255,255,.10);
      background: rgba(12,14,22,.82);
      padding:18px 18px 16px;
      box-shadow: 0 10px 24px rgba(0,0,0,.25);
    }
    .panel h3{
      margin:0 0 10px;
      font-size:14px;
      letter-spacing:.10em;
      text-transform:uppercase;
      opacity:.92;
    }
    .list{
      margin:0;
      padding-left: 1.2em;
      line-height:1.9;
      color: rgba(255,255,255,.88);
      font-size:13px;
    }

    /* Map block */
    .map-wrap{
      border-radius: var(--radius);
      border:1px solid #e3e3ea;
      background:#ffffff; padding: 14px;
      box-shadow: 0 10px 24px rgba(0,0,0,.06);
    }
    .map-head{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .map-head .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:5px 10px;
      border-radius:999px;
      border:1px solid #e7e7ef;
      background:#fff;
      font-size:11px;
      color:#444;
    }
    .map-area{
      border-radius: 14px;
      overflow:hidden;
      background:#0b1020;
      border:1px solid rgba(124,58,237,.20);
      position:relative;
      aspect-ratio: 16 / 9;
      min-height: 220px;
    }
    .map-area svg{
      width:100%;
      height:100%;
      display:block;
    }
    .map-hint{
      margin-top:10px;
      font-size:12px;
      color:#555;
      line-height:1.8;
    }
    .map-legend{
      display:flex; flex-wrap:wrap; gap:8px;
      margin-top:10px;
    }
    .legend{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:11px;
      color:#444;
      background:#fff;
      border:1px solid #e7e7ef;
      border-radius:999px;
      padding:5px 10px;
    }
    .dot{ width:10px; height:10px; border-radius:999px; display:inline-block; }
    .lv0{ background:#cbd5e1; }
    .lv1{ background:#a5b4fc; }
    .lv2{ background:#8b5cf6; }
    .lv3{ background:#7c3aed; }

    /* Cards grid for detail pages preview */
    .cards{
      display:grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap:14px;
      margin-top: 22px;
    }
    .card{
      border-radius: 16px;
      border:1px solid var(--border);
      background: var(--card);
      padding: 14px 14px 12px;
      box-shadow: 0 10px 24px rgba(0,0,0,.06);
      display:grid;
      gap:6px;
      cursor:pointer;
      transition: transform .16s ease, box-shadow .16s ease, border-color .16s ease;
    }
    .card:hover{
      transform: translateY(-2px);
      border-color: var(--accent);
      box-shadow: 0 14px 32px rgba(0,0,0,.10);
    }
    .thumb{
      border-radius: 12px;
      overflow:hidden;
      background:#111827;
      aspect-ratio: 16 / 9;
      border:1px solid rgba(0,0,0,.06);
    }
    .thumb img{ width:100%; height:100%; object-fit:cover; }
    .card .kicker{
      font-size:10px;
      letter-spacing:.22em;
      text-transform:uppercase;
      color: var(--accent2);
      margin-top: 2px;
    }
    .card .title{
      font-size:14px;
      font-weight:900;
      line-height:1.45;
    }
    .card .desc{
      font-size:12px;
      color:#555;
      line-height:1.75;
    }
    .card .cta{
      margin-top:4px;
      font-size:11px;
      color: var(--accent2);
      text-align:right;
    }

    /* Light sections */
    .sec-gray{ background: var(--bg-gray); }
    .split{
      display:grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.6fr);
      gap: 26px;
      align-items:flex-start;
    }
    .box{
      border-radius: var(--radius);
      border:1px solid var(--border);
      background:#fff;
      padding:18px 18px 16px;
      box-shadow: 0 10px 24px rgba(0,0,0,.06);
    }
    .box h3{ margin:0 0 10px; font-size:14px; font-weight:900; }
    .box p{ margin:0; color:#555; line-height:1.9; font-size:13px; }
    .box ul{ margin:10px 0 0; padding-left:1.2em; color:#555; line-height:1.9; font-size:13px; }

    /* YouTube embed */
    .embed{
      border-radius: 16px;
      overflow:hidden;
      border:1px solid rgba(0,0,0,.08);
      background:#000;
      aspect-ratio: 16 / 9;
      min-height: 220px;
    }
    .embed iframe{ width:100%; height:100%; border:0; display:block; }

    /* Work CTA */
    .cta-wide{
      max-width: 820px;
      margin: 26px auto 0;
      border-radius: 18px;
      background: #fff;
      border: 1px solid rgba(124,58,237,.30);
      box-shadow: var(--shadow);
      padding: 22px 20px 22px;
      text-align:center;
    }
    .cta-wide .big{
      font-size:20px;
      font-weight:900;
      margin:0 0 10px;
    }
    .cta-wide .lead{
      margin:0 0 18px;
      font-size:14px;
      line-height:1.9;
      color:#555;
    }

    /* Footer */
    footer{
      border-top:1px solid rgba(255,255,255,.08);
      background: rgba(5,6,11,1);
      color: rgba(255,255,255,.70);
      padding: 18px 18px 22px;
      font-size: 11px;
    }
    .footer-inner{
      max-width:var(--max);
      margin:0 auto;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    /* ä¸Šæ®µï¼šä¸­å¤®æƒãˆ */
    .footer-row-top{
      display:flex;
      justify-content:center;
      padding-top:6px;
    }
    .footer-logo{
      height: 100px;
      width: auto;
      display:block;
    }
    /* ä¸‹æ®µï¼š3åˆ†å‰²å›ºå®šï¼ˆå·¦/ä¸­å¤®/å³ï¼‰ */
    .footer-row-bottom{
      display:grid;
      grid-template-columns: 1fr auto 1fr;
      align-items:center;
      gap:12px;
    }
    .footer-left{ justify-self:start; }
    .footer-center{ justify-self:center; }
    .footer-right{ justify-self:end; }
    .footer-links{ display:flex; gap:12px; }

    /* Scroll animation */
    .scroll-fade{
      opacity:0;
      transform: translateY(26px);
      transition: opacity .7s ease-out, transform .7s ease-out;
    }
    .scroll-fade.is-visible{
      opacity:1;
      transform: translateY(0);
    }

    /* Dialog */
    dialog{
      border:none;
      border-radius: 16px;
      width:min(620px, 92vw);
      padding: 18px 18px 16px;
    }
    dialog::backdrop{ background: rgba(0,0,0,.38); }
    .dlg-head{
      display:flex; justify-content:space-between; align-items:flex-start; gap: 12px;
    }
    .dlg-head h3{ margin:0; font-size:16px; font-weight:900; }
    .dlg-close{
      border:1px solid #e7e7ef;
      background:#fff;
      border-radius: 10px;
      padding: 8px 10px;
      cursor:pointer;
    }
    .dlg-meta{
      margin:6px 0 0;
      font-size:12px;
      color:#555;
      line-height:1.8;
    }
    .dlg-links{
      margin-top: 10px;
      display:flex; flex-wrap:wrap; gap: 10px;
      font-size:12px;
    }
    .dlg-links a{
      border:1px solid #e7e7ef;
      border-radius: 999px;
      padding: 7px 12px;
      background:#fff;
    }

    /* Responsive */
    @media (max-width: 980px){
      .hero-inner{ grid-template-columns: minmax(0, 1fr); gap: 24px; }
      .category-inner{ grid-template-columns: repeat(2, minmax(0,1fr)); }
      .grid-2, .split{ grid-template-columns: minmax(0,1fr); }
      .cards{ grid-template-columns: repeat(2, minmax(0,1fr)); }
    }
    @media (max-width: 720px){
      nav.nav{ display:none; }
      .nav-toggle{ display:flex; }
      main section{ padding: 62px 16px 66px; }
      .hero-inner{ padding: 44px 16px 56px; }
    }
    @media (max-width: 520px){
      .cards{ grid-template-columns: minmax(0,1fr); }
      .hero-title-ja{ font-size: 18px; }
      .hero-title-en{ font-size: 24px; }
    }

    /* Accessibility */
    .visually-hidden{
      position:absolute !important;
      height:1px; width:1px;
      overflow:hidden;
      clip: rect(1px,1px,1px,1px);
      white-space:nowrap;
    }
  
    /* ---------------- Country Notes (dropdown banners) ---------------- */

    /* Banner with right-side flag image + left fade */
    summary.country-banner{
      position: relative;
      overflow:hidden;
      padding-right: 150px; /* space for flag image */
    }
    .country-banner .iso{
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      opacity:.75;
      min-width: 28px;
    }
    .country-banner .meta{ margin-left:auto; }
    
    
    .banner-flagimg{
      position:absolute;
      inset:-18px -10px -18px auto; /* overflow beyond banner height */
      width: 210px;
      opacity: 1;
      pointer-events:none;
    }
    
    
    .banner-flagimg::after{
      content:"";
      position:absolute;
      right: 10px;
      top: 50%;
      width: 140px;
      height: 140px;
      transform: translateY(-50%) rotate(2deg);
      background-image: var(--flag);
      background-repeat:no-repeat;
      background-position:center;
      background-size: contain;
      filter: drop-shadow(0 10px 16px rgba(0,0,0,.14));
      /* Fade ONLY the left 25% of the FLAG itself */
      -webkit-mask-image: linear-gradient(
        90deg,
        rgba(0,0,0,0) 0%,
        rgba(0,0,0,1) 25%,
        rgba(0,0,0,1) 100%
      );
      mask-image: linear-gradient(
        90deg,
        rgba(0,0,0,0) 0%,
        rgba(0,0,0,1) 25%,
        rgba(0,0,0,1) 100%
      );
      -webkit-mask-size: 100% 100%;
      mask-size: 100% 100%;
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
    }

/* Dark-mode-ish background still shows: keep it subtle */
    details.country-dd{background:#ffffff;}

    .country-notes{ margin-top: 10px; }
    details.country-dd{
      border-radius: 16px;
      border:1px solid var(--border);
      background:#fff;
      box-shadow: 0 10px 24px rgba(0,0,0,.06);
      overflow:hidden;
      margin: 12px 0;
    }
    details.country-dd[open] .chev{ transform: rotate(180deg); }
    summary.country-banner{
      list-style:none;
      display:flex;
      align-items:center;
      gap:12px;
      padding: 14px 14px;
      cursor:pointer;
      user-select:none;
      background: #ffffff;border-bottom:1px solid rgba(0,0,0,.04);
    }
    summary.country-banner::-webkit-details-marker{ display:none; }
    .country-banner .flag{ font-size:18px; }
    .country-banner .name{ font-weight:900; letter-spacing:.04em; }
    .country-banner .meta{ margin-left:auto; font-size:11px; color:#6b7280; }
    .country-banner .chev{ font-size:14px; opacity:.7; transition: transform .16s ease; }

    .country-body{ padding: 14px; background:#fff; }
    .note-card{
      border-radius: 14px;
      border:1px solid rgba(124,58,237,.25);
      background: rgba(124,58,237,.04);
      padding: 14px 14px 12px;
      display:grid;
      gap: 6px;
    }
    .note-kicker{
      font-size:10px;
      letter-spacing:.22em;
      text-transform:uppercase;
      color: var(--accent2);
    }
    .note-title{ font-size:14px; font-weight:900; }
    .note-text{ font-size:12px; color:#444; line-height:1.85; }
    .note-actions{ display:flex; flex-wrap:wrap; gap:10px; margin-top:8px; }
    .note-btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:6px;
      padding: 8px 12px;
      border-radius: 999px;
      border:1px solid rgba(124,58,237,.35);
      background:#fff;
      color: var(--accent2);
      font-size:12px;
      font-weight:700;
      letter-spacing:.08em;
    }
    .note-btn.subtle{
      border-color: rgba(0,0,0,.10);
      color:#444;
    }

    /* Jump highlight for the world card */
    @keyframes cardPulse {
      0% { box-shadow: 0 0 0 rgba(124,58,237,0); transform: translateY(0); }
      30% { box-shadow: 0 0 0 6px rgba(124,58,237,.18); transform: translateY(-2px); }
      100% { box-shadow: 0 0 0 rgba(124,58,237,0); transform: translateY(0); }
    }
    .country-dd.is-target{
      border-color: var(--accent);
      animation: cardPulse 1.1s ease-out 0s 2;
    }

    .card.is-target{
      border-color: var(--accent);
      animation: cardPulse 1.1s ease-out 0s 2;
    }


    /* Hide top-right CLICK badge and bottom legend/note area (world page) */
    .map-head .badge:nth-child(2){ display:none !important; }
    .map-legend{ display:none !important; }


    /* Link to Japan page (inside left badge) */
    .wj-toggle{
      margin-left: 10px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      color: rgba(255,255,255,.92);
      cursor:pointer;
      vertical-align: middle;
      text-decoration: none;
    }
    .wj-toggle:hover{ background: rgba(255,255,255,.10); }
    .wj-ic{ font-size: 14px; line-height: 1; }
    .wj-mid{ opacity: .7; font-weight: 900; }

</style>
</head>
<body>
<header class="header">
  <div class="header-inner" style="justify-content:flex-end;">
    <a href="index.html" style="
      border:1px solid rgba(255,255,255,.6);
      padding:10px 18px;
      border-radius:999px;
      text-decoration:none;
      font-size:12px;
      letter-spacing:.18em;
      text-transform:uppercase;
      display:inline-flex;
      align-items:center;
      justify-content:center;
    ">Return</a>
  </div>
</header>
<main>
<section class="sec-gray" id="exp">
      <div class="section-inner scroll-fade">
        <h2 class="section-title">EXPERIENCE</h2>
        <div class="section-title-sub">tap map â†’ detail page</div>

        <div class="map-wrap">
          <div class="map-head">
            <div class="badge">WORLD MAP
<a class="wj-toggle" href="02_experience_japan.html" aria-label="World â‡” Japan" title="Switch to Japan">
  <span class="wj-ic" aria-hidden="true">ğŸŒâ¡ï¸ğŸ—¾</span>
</a>
</div>
            <div class="badge">CLICK: Japan / Finland / USA / Korea / Taiwan / Singapore / Sweden / Norway</div>
          </div>

          <div class="map-area" aria-label="world map">
            <!-- Precise world map (TopoJSON â†’ SVG). Countries are real borders. -->
            <svg id="worldMap" viewBox="0 0 1200 675" role="img" aria-label="ä¸–ç•Œåœ°å›³ï¼ˆæ­£ç¢ºç‰ˆï¼‰"></svg>
          </div>

          <div class="map-legend" aria-label="legend">
            <div class="legend"><span class="dot lv0"></span>Lv0 æœªè¨ªå•</div>
            <div class="legend"><span class="dot lv1"></span>Lv1 é€šé</div>
            <div class="legend"><span class="dot lv2"></span>Lv2 æ»åœ¨</div>
            <div class="legend"><span class="dot lv3"></span>Lv3 æ·±ã„çµŒé¨“</div>
          </div>
        </div>

        
        <!-- Country notes (sample) -->
        <div class="country-notes" id="countryNotes" aria-label="country notes">
          <div class="section-label" style="margin-top:36px;">COUNTRY NOTES</div>
          

          

          


          

          

          

          




          

          














<details class="country-dd" id="dd-Japan">
            <summary class="country-banner" data-country="Japan">
              <span class="iso">JP</span>
              <span class="name">Japan</span>
              <span class="meta">ã‚µãƒ³ãƒ—ãƒ« â€¢ Lv2</span>
              <span class="chev">â–¾</span>
              <span class="banner-flagimg" style="--flag:url('https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f1ef-1f1f5.svg')" aria-hidden="true"></span>
            </summary>
            <div class="country-body">
              <div class="cards" aria-label="Japan cards" style="grid-template-columns: repeat(2, minmax(0,1fr));">
                <article class="card" onclick="location.href='experience/jp.html'">
                  <div class="thumb"><img src="images/japan_map_thumb.jpg" alt="Japanã®çµŒé¨“å€¤ãƒãƒƒãƒ—ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">experience</div>
                  <div class="title">Japanï¼šçµŒçœŒå€¤</div>
                  <div class="desc">éƒ½é“åºœçœŒã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã€ãƒ¡ãƒ¢ãƒ»å†™çœŸãƒ»å‹•ç”»ã¸ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
                <article class="card" onclick="location.href='experience/notes.html'">
                  <div class="thumb"><img src="images/travel_thumb.jpg" alt="Japanã®æ—…è¡Œãƒ­ã‚°ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">note</div>
                  <div class="title">Japanï¼šæ—…è¡Œã®è¶³è·¡ãƒ­ã‚°</div>
                  <div class="desc">å†™çœŸãƒ»çŸ­æ–‡ãƒ»å‹•ç”»ãƒªãƒ³ã‚¯ã‚’ã‚«ãƒ¼ãƒ‰ã§æ•´ç†ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
              </div>
            </div>
          </details>

<details class="country-dd" id="dd-Korea">
            <summary class="country-banner" data-country="Korea">
              <span class="iso">KR</span>
              <span class="name">Korea</span>
              <span class="meta">ã‚µãƒ³ãƒ—ãƒ« â€¢ Lv1</span>
              <span class="chev">â–¾</span>
              <span class="banner-flagimg" style="--flag:url('https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f1f0-1f1f7.svg')" aria-hidden="true"></span>
            </summary>
            <div class="country-body">
              <div class="cards" aria-label="Korea cards" style="grid-template-columns: repeat(2, minmax(0,1fr));">
                <article class="card" onclick="location.href='experience/kr.html'">
                  <div class="thumb"><img src="images/korea_map_thumb.jpg" alt="Koreaã®çµŒé¨“å€¤ãƒãƒƒãƒ—ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">experience</div>
                  <div class="title">Koreaï¼šçµŒé¨“å€¤</div>
                  <div class="desc">è¨ªå•ãƒ­ã‚°ãƒ»å†™çœŸãƒ»ãƒ¡ãƒ¢ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
                <article class="card" onclick="location.href='experience/notes_kr.html'">
                  <div class="thumb"><img src="images/korea_note_thumb.jpg" alt="Koreaãƒãƒ¼ãƒˆã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">note</div>
                  <div class="title">Koreaï¼šãƒãƒ¼ãƒˆ</div>
                  <div class="desc">æ°—ã¥ããƒ»ãŠã™ã™ã‚ãƒ»ãƒªãƒ³ã‚¯é›†ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
              </div>
            </div>
          </details>

<details class="country-dd" id="dd-Taiwan">
            <summary class="country-banner" data-country="Taiwan">
              <span class="iso">TW</span>
              <span class="name">Taiwan</span>
              <span class="meta">ã‚µãƒ³ãƒ—ãƒ« â€¢ Lv1</span>
              <span class="chev">â–¾</span>
              <span class="banner-flagimg" style="--flag:url('https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f1f9-1f1fc.svg')" aria-hidden="true"></span>
            </summary>
            <div class="country-body">
              <div class="cards" aria-label="Taiwan cards" style="grid-template-columns: repeat(2, minmax(0,1fr));">
                <article class="card" onclick="location.href='experience/tw.html'">
                  <div class="thumb"><img src="images/taiwan_map_thumb.jpg" alt="Taiwanã®çµŒé¨“å€¤ãƒãƒƒãƒ—ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">experience</div>
                  <div class="title">Taiwanï¼šçµŒé¨“å€¤</div>
                  <div class="desc">éƒ½å¸‚ãƒ»ã‚¹ãƒãƒƒãƒˆåˆ¥ã«æ•´ç†ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
                <article class="card" onclick="location.href='experience/notes_tw.html'">
                  <div class="thumb"><img src="images/taiwan_note_thumb.jpg" alt="Taiwanãƒãƒ¼ãƒˆã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">note</div>
                  <div class="title">Taiwanï¼šãƒãƒ¼ãƒˆ</div>
                  <div class="desc">é£Ÿãƒ»ç§»å‹•ãƒ»Tipsã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
              </div>
            </div>
          </details>


<details class="country-dd" id="dd-Singapore">
            <summary class="country-banner" data-country="Singapore">
              <span class="iso">SG</span>
              <span class="name">Singapore</span>
              <span class="meta">ã‚µãƒ³ãƒ—ãƒ« â€¢ Lv2</span>
              <span class="chev">â–¾</span>
              <span class="banner-flagimg" style="--flag:url('https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f1f8-1f1ec.svg')" aria-hidden="true"></span>
            </summary>
            <div class="country-body">
              <div class="cards" aria-label="Singapore cards" style="grid-template-columns: repeat(2, minmax(0,1fr));">
                <article class="card" onclick="location.href='experience/sg.html'">
                  <div class="thumb"><img src="images/singapore_map_thumb.jpg" alt="Singaporeã®çµŒé¨“å€¤ãƒãƒƒãƒ—ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">experience</div>
                  <div class="title">Singaporeï¼šçµŒé¨“å€¤</div>
                  <div class="desc">éƒ½å¸‚å›½å®¶ã®ç§»å‹•ãƒ»å»ºç¯‰ãƒ»è¡—æ­©ãè¨˜éŒ²ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
                <article class="card" onclick="location.href='experience/notes_sg.html'">
                  <div class="thumb"><img src="images/singapore_note_thumb.jpg" alt="Singaporeãƒãƒ¼ãƒˆã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">note</div>
                  <div class="title">Singaporeï¼šãƒãƒ¼ãƒˆ</div>
                  <div class="desc">äº¤é€šãƒ»éƒ½å¸‚è¨­è¨ˆãƒ»æ°—ã¥ããƒ¡ãƒ¢ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
              </div>
            </div>
          </details>



<details class="country-dd" id="dd-Finland">
            <summary class="country-banner" data-country="Finland">
              <span class="iso">FI</span>
              <span class="name">Finland</span>
              <span class="meta">ã‚µãƒ³ãƒ—ãƒ« â€¢ Lv2</span>
              <span class="chev">â–¾</span>
              <span class="banner-flagimg" style="--flag:url('https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f1eb-1f1ee.svg')" aria-hidden="true"></span>
            </summary>
            <div class="country-body">
            <div class="country-body">
              <div class="cards" aria-label="Finland cards" style="grid-template-columns: repeat(2, minmax(0,1fr));">
                <article class="card" onclick="location.href='experience/world.html#finland'">
                  <div class="thumb"><img src="images/world_map_thumb.jpg" alt="Finlandã®çµŒé¨“å€¤ãƒãƒƒãƒ—ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">experience</div>
                  <div class="title">Finlandï¼šVisited Map</div>
                  <div class="desc">å›½åˆ¥ã®è¨˜éŒ²ã¸ï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
                <article class="card" onclick="location.href='note.html'">
                  <div class="thumb"><img src="images/travel_thumb.jpg" alt="Finlandã®ãƒãƒ¼ãƒˆã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">note</div>
                  <div class="title">Finlandï¼šæ»åœ¨ãƒ¡ãƒ¢ï¼ˆè¡—æ­©ã / æ–‡åŒ–ï¼‰</div>
                  <div class="desc">ã¾ã è¨˜äº‹ã¯æœªä½œæˆã€‚æ°—ã¥ããƒ»å†™çœŸãƒ»çŸ­æ–‡ãƒ»å‹•ç”»ãƒªãƒ³ã‚¯ã‚’NoteåŒ–ã—ã¦ã€ã“ã®å›½åˆ¥ãƒãƒŠãƒ¼ã«çµ„ã¿è¾¼ã¿äºˆå®šã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
              </div>
            </div>
            </div>
</div>
          </details>

<details class="country-dd" id="dd-Norway">
            <summary class="country-banner" data-country="Norway">
              <span class="iso">NO</span>
              <span class="name">Norway</span>
              <span class="meta">ã‚µãƒ³ãƒ—ãƒ« â€¢ Lv3</span>
              <span class="chev">â–¾</span>
              <span class="banner-flagimg" style="--flag:url('https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f1f3-1f1f4.svg')" aria-hidden="true"></span>
            </summary>
            <div class="country-body">
              <div class="cards" aria-label="Norway cards" style="grid-template-columns: repeat(2, minmax(0,1fr));">
                <article class="card" onclick="location.href='experience/no.html'">
                  <div class="thumb"><img src="images/norway_map_thumb.jpg" alt="Norwayã®çµŒé¨“å€¤ãƒãƒƒãƒ—ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">experience</div>
                  <div class="title">Norwayï¼šçµŒé¨“å€¤</div>
                  <div class="desc">æ—…ã®ãƒ­ã‚°ã‚’åœ°å›³ã§å¯è¦–åŒ–ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
                <article class="card" onclick="location.href='experience/notes_no.html'">
                  <div class="thumb"><img src="images/norway_note_thumb.jpg" alt="Norwayãƒãƒ¼ãƒˆã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">note</div>
                  <div class="title">Norwayï¼šãƒãƒ¼ãƒˆ</div>
                  <div class="desc">ã‚ªãƒ¼ãƒ­ãƒ©ãƒ»ç§»å‹•ãƒ»è£…å‚™ãªã©ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
              </div>
            </div>
          </details>

<details class="country-dd" id="dd-Sweden">
            <summary class="country-banner" data-country="Sweden">
              <span class="iso">SE</span>
              <span class="name">Sweden</span>
              <span class="meta">ã‚µãƒ³ãƒ—ãƒ« â€¢ Lv2</span>
              <span class="chev">â–¾</span>
              <span class="banner-flagimg" style="--flag:url('https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f1f8-1f1ea.svg')" aria-hidden="true"></span>
            </summary>
            <div class="country-body">
              <div class="cards" aria-label="Sweden cards" style="grid-template-columns: repeat(2, minmax(0,1fr));">
                <article class="card" onclick="location.href='experience/se.html'">
                  <div class="thumb"><img src="images/sweden_map_thumb.jpg" alt="Swedenã®çµŒé¨“å€¤ãƒãƒƒãƒ—ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">experience</div>
                  <div class="title">Swedenï¼šçµŒé¨“å€¤</div>
                  <div class="desc">è¨ªå•ã®è¶³è·¡ã‚’ã¾ã¨ã‚ã‚‹ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
                <article class="card" onclick="location.href='experience/notes_se.html'">
                  <div class="thumb"><img src="images/sweden_note_thumb.jpg" alt="Swedenãƒãƒ¼ãƒˆã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">note</div>
                  <div class="title">Swedenï¼šãƒãƒ¼ãƒˆ</div>
                  <div class="desc">è¡—æ­©ããƒ¡ãƒ¢ãƒ»ãƒªãƒ³ã‚¯ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
              </div>
            </div>
          </details>

<details class="country-dd" id="dd-USA">
            <summary class="country-banner" data-country="USA">
              <span class="iso">US</span>
              <span class="name">USA</span>
              <span class="meta">ã‚µãƒ³ãƒ—ãƒ« â€¢ Lv1</span>
              <span class="chev">â–¾</span>
              <span class="banner-flagimg" style="--flag:url('https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/svg/1f1fa-1f1f8.svg')" aria-hidden="true"></span>
            </summary>
            <div class="country-body">
            <div class="country-body">
              <div class="cards" aria-label="USA cards" style="grid-template-columns: repeat(2, minmax(0,1fr));">
                <article class="card" onclick="location.href='experience/world.html#usa'">
                  <div class="thumb"><img src="images/world_map_thumb.jpg" alt="USAã®çµŒé¨“å€¤ãƒãƒƒãƒ—ã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">experience</div>
                  <div class="title">USAï¼šVisited Map</div>
                  <div class="desc">å›½åˆ¥ã®è¨˜éŒ²ã¸ï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
                <article class="card" onclick="location.href='note.html'">
                  <div class="thumb"><img src="images/travel_thumb.jpg" alt="USAã®ãƒãƒ¼ãƒˆã®ã‚µãƒ ãƒã‚¤ãƒ«"></div>
                  <div class="kicker">note</div>
                  <div class="title">USAï¼šé€šé / çŸ­æœŸã®è¨˜éŒ²</div>
                  <div class="desc">ã¾ã è¨˜äº‹ã¯æœªä½œæˆã€‚ä»Šå¾Œã€æ—…è¡Œãƒ­ã‚°ãƒ»åˆ¶ä½œãƒ»å†™çœŸãªã©ã‚’Noteã¨ã—ã¦æ•´ç†ã—ã€ã“ã®å›½åˆ¥ãƒãƒŠãƒ¼ã«çµ„ã¿è¾¼ã¿ã¾ã™ã€‚</div>
                  <div class="cta">OPEN â†’</div>
                </article>
              </div>
            </div>
            </div>
</div>
          </details>


</main>
<footer>
    <div class="footer-inner">
      <!-- ä¸Šæ®µï¼šç”»åƒ -->
      <div class="footer-row footer-row-top">
        <a href="index.html" aria-label="HOMEã¸ï¼ˆãƒ•ãƒƒã‚¿ãƒ¼ãƒ­ã‚´ï¼‰" style="display:inline-block;"><img src="images/top2.png" alt="HEIHEY" class="footer-logo"></a>
      </div>
      <!-- ä¸‹æ®µï¼š3åˆ†å‰² -->
      <div class="footer-row footer-row-bottom">
        <div class="footer-left">Â© HEIHEY PORTAL</div>
        <div class="footer-center footer-links"><a href="#top">TOP</a></div>
        <div class="footer-right" style="opacity:.78;">
          Last update: <span id="lastUpdate"></span>
        </div>
      </div>
    </div>
  </footer>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/topojson-client@3"></script>

<script>
    
    // Banner ordering rule (memo):
    // - World: Japan first, then by AREA, then alphabetically in area.
    // - Area order: Asia, Europe, America, Oceania, Africa, Other.

// --- Mobile nav ---
    const navToggle = document.getElementById("navToggle");
    const navSp = document.getElementById("navSp");
    navToggle?.addEventListener("click", () => {
      const isOpen = document.body.classList.toggle("nav-open");
      navToggle.setAttribute("aria-expanded", isOpen ? "true" : "false");
    });
    navSp?.querySelectorAll("a").forEach(a => a.addEventListener("click", () => {
      document.body.classList.remove("nav-open");
      navToggle.setAttribute("aria-expanded", "false");
    }));

    // --- Scroll fade-in ---
    const scrollEls = document.querySelectorAll(".scroll-fade");
    const obs = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if(entry.isIntersecting){
          entry.target.classList.add("is-visible");
          obs.unobserve(entry.target);
        }
      });
    }, { threshold: 0.18 });
    scrollEls.forEach(el => obs.observe(el));

    // --- Footer date ---
    const d = new Date();
    document.getElementById("lastUpdate").textContent = d.toISOString().slice(0,10);

    
    // --- Precise WORLD MAP (TopoJSON -> SVG) ---
    // Uses world-atlas countries-110m (real borders). Lightweight enough for a portfolio page.
    // Country IDs are ISO 3166-1 numeric codes in this dataset.
    const MAP_W = 1200;
    const MAP_H = 675;

    const worldSvg = d3.select("#worldMap")
      .attr("viewBox", `0 0 ${MAP_W} ${MAP_H}`)
      .attr("width", "100%")
      .attr("height", "100%");

    // Background defs (sea gradient + glow) to keep the existing design feel.
    const defs = worldSvg.append("defs");

    const sea = defs.append("linearGradient").attr("id", "sea").attr("x1", 0).attr("x2", 1);
    sea.append("stop").attr("offset", "0%").attr("stop-color", "#070a18");
    sea.append("stop").attr("offset", "100%").attr("stop-color", "#0c1430");

    const glow = defs.append("filter").attr("id", "glow").attr("x", "-20%").attr("y", "-20%").attr("width", "140%").attr("height", "140%");
    glow.append("feGaussianBlur").attr("stdDeviation", 4).attr("result", "b");
    const merge = glow.append("feMerge");
    merge.append("feMergeNode").attr("in", "b");
    merge.append("feMergeNode").attr("in", "SourceGraphic");

    worldSvg.append("rect")
      .attr("width", MAP_W)
      .attr("height", MAP_H)
      .attr("fill", "url(#sea)");

    // Projection chosen for natural look (good for "experience map").
    const projection = d3.geoNaturalEarth1()
      .scale(215)
      .translate([MAP_W / 2, MAP_H / 2]);

    const geoPath = d3.geoPath(projection);

    // Groups for layering (countries -> borders -> labels/markers)
    const gMap = worldSvg.append("g").attr("class", "wm-map");
    const gBorders = worldSvg.append("g").attr("class", "wm-borders");
    const gMarks = worldSvg.append("g").attr("class", "wm-marks").attr("filter", "url(#glow)");

    // Tiny tooltip (no CSS dependency)
    const tooltip = document.createElement("div");
    tooltip.style.position = "fixed";
    tooltip.style.pointerEvents = "none";
    tooltip.style.zIndex = "9999";
    tooltip.style.padding = "6px 10px";
    tooltip.style.borderRadius = "10px";
    tooltip.style.fontSize = "12px";
    tooltip.style.color = "rgba(255,255,255,.92)";
    tooltip.style.background = "rgba(0,0,0,.55)";
    tooltip.style.border = "1px solid rgba(255,255,255,.18)";
    tooltip.style.backdropFilter = "blur(10px)";
    tooltip.style.opacity = "0";
    tooltip.style.transform = "translateY(4px)";
    tooltip.style.transition = "opacity .12s ease, transform .12s ease";
    document.body.appendChild(tooltip);

    function showTip(text, x, y){
      tooltip.textContent = text;
      tooltip.style.left = (x + 12) + "px";
      tooltip.style.top  = (y + 12) + "px";
      tooltip.style.opacity = "1";
      tooltip.style.transform = "translateY(0)";
    }
    function hideTip(){
      tooltip.style.opacity = "0";
      tooltip.style.transform = "translateY(4px)";
    }

    // Map numeric IDs -> your existing modal content.
    // ISO 3166-1 numeric: Japan=392, Finland=246, USA=840
    const COUNTRY_TO_BANNER = {
      392: "Japan",
      246: "Finland",
      840: "USA",
      410: "Korea",
      158: "Taiwan",
      702: "Singapore",
      752: "Sweden",
      578: "Norway"
    };

    const COUNTRY_LABEL = {
      392: "Japan",
      246: "Finland",
      840: "USA",
      410: "Korea",
      158: "Taiwan",
      702: "Singapore",
      752: "Sweden",
      578: "Norway"
    };

    // Manual markers for tiny countries that may be missing / too small in 110m dataset
    // lon/lat in degrees (WGS84)
    const MANUAL_MARKERS = [
      { name: "Singapore", lon: 103.8198, lat: 1.3521 }
    ];


    function markerForCountry(feature){
      const c = geoPath.centroid(feature);
      if(!Number.isFinite(c[0]) || !Number.isFinite(c[1])) return;

      const name = COUNTRY_TO_BANNER[feature.id];
      if(!name) return;

      gMarks.append("circle")
        .attr("cx", c[0])
        .attr("cy", c[1])
        .attr("r", 8.5)
        .attr("fill", "rgba(124,58,237,.92)")
        .attr("stroke", "#fff")
        .attr("stroke-width", 2)
        .style("cursor","pointer")
        .on("click", () => jumpToCountry(name));
    }

    d3.json("https://cdn.jsdelivr.net/npm/world-atlas@2/countries-110m.json")
      .then((topology) => {
        const countries = topojson.feature(topology, topology.objects.countries);
        const borders = topojson.mesh(topology, topology.objects.countries, (a, b) => a !== b);

        // Countries
        gMap.selectAll("path")
          .data(countries.features)
          .enter()
          .append("path")
          .attr("d", geoPath)
          .attr("fill", "rgba(255,255,255,.09)")
          .attr("stroke", "rgba(255,255,255,.06)")
          .attr("stroke-width", 0.7)
          .style("cursor", "pointer")
          .on("mousemove", (event, d) => showTip(COUNTRY_LABEL[d.id] || `Country ID: ${d.id}`, event.clientX, event.clientY))
          .on("mouseleave", hideTip)
          .on("click", (event, d) => {
            const name = COUNTRY_TO_BANNER[d.id];
            if(name){
              jumpToCountry(name);
            }
          });

        // Borders
        gBorders.append("path")
          .datum(borders)
          .attr("d", geoPath)
          .attr("fill", "none")
          .attr("stroke", "rgba(255,255,255,.14)")
          .attr("stroke-width", 0.9);

        // Markers for demo countries
        countries.features
          .filter(f => COUNTRY_TO_BANNER[f.id])
          .forEach(markerForCountry);

        // Manual markers (tiny countries may be missing/too small in 110m)
        (MANUAL_MARKERS || []).forEach(mk => {
          const p = projection([mk.lon, mk.lat]);
          if(!p || !Number.isFinite(p[0]) || !Number.isFinite(p[1])) return;
          gMarks.append("circle")
            .attr("cx", p[0])
            .attr("cy", p[1])
            .attr("r", 8.5)
            .attr("fill", "rgba(124,58,237,.92)")
            .attr("stroke", "#fff")
            .attr("stroke-width", 2)
            .style("cursor","pointer")
            .on("click", () => jumpToCountry(mk.name));
        });
      })
      .catch((err) => {
        console.error("Failed to load world map TopoJSON:", err);
        console.error("World map load error");
        alert("World map load error\\nåœ°å›³ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
      });

    // --- Jump from map marker (red arrow) to lower banner ---
    
    
    function jumpToCountry(country){
      const el = document.getElementById("dd-" + country);
      if(!el) return;
      el.open = true; // open dropdown
      el.scrollIntoView({ behavior: "smooth", block: "center" });
      el.classList.add("is-target");
      setTimeout(()=> el.classList.remove("is-target"), 2400);
    }


    function jumpToWorldCard(){
      const el = document.getElementById("worldCard");
      if(!el) return;
      el.scrollIntoView({ behavior: "smooth", block: "center" });
      el.classList.add("is-target");
      window.setTimeout(() => el.classList.remove("is-target"), 2600);
    }

    function openExp(id){
      const data = EXP[id];
      if(!data) return;
      mTitle.textContent = data.title;
      mBody.textContent  = data.body;
      mLinks.innerHTML   = (data.links||[]).map(l => `<a href="${l.url}">${l.label} â†’</a>`).join("");
      modal.showModal();
    }

    Object.keys(EXP).forEach(id => {
      const el = document.getElementById(id);
      if(!el) return;
      el.style.cursor = "pointer";
      el.addEventListener("click", () => openExp(id));
      el.addEventListener("keydown", (e) => {
        if(e.key === "Enter" || e.key === " ") openExp(id);
      });
      el.setAttribute("tabindex", "0");
      el.setAttribute("role", "button");
      el.setAttribute("aria-label", "Open " + (EXP[id]?.title || id));
    });
  </script>
</body>
</html>